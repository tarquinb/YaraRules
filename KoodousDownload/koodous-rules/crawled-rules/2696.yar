
rule BadAccents : ccm

{

        meta:

        description = "This rule was produced by CreateYaraRule and CommonCode, it detects badAccents malware"

        author = "_hugo_gonzalez_ "

        samples = "1e82fefd6b2c6f9a3f10d414180459d1067601ba16facd4a1aaff6921078015f"

        strings :


        $S_7_54_34 = { 54 20 03 00 71 10 ?? 00 00 00 0c 00 12 01 46 01 03 01 71 10 45 00 01 00 0a 01 6e 20 07 00 10 00 0e 00 }

        $S_7_22_116 = { 22 00 ?? 00 1a 01 ?? 00 70 20 0a 00 10 00 22 01 ?? 00 22 02 ?? 00 71 00 0f 00 00 00 0c 03 6e 10 3b 00 03 00 0c 03 71 10 4d 00 03 00 0c 03 70 20 4f 00 32 00 1a 03 02 00 6e 20 51 00 32 00 0c 02 6e 10 52 00 02 00 0c 02 70 20 39 00 21 00 71 10 0c 00 01 00 0c 01 1a 02 ?? 00 6e 30 0b 00 10 02 6e 20 31 00 04 00 0e 00 0d 01 28 fe 0d 01 28 fc 0d 01 28 fa }

        $S_7_22_274 = { 22 0b ?? 00 12 0c 46 0c 14 0c 70 20 53 00 cb 00 6e 10 54 00 0b 00 0c 02 6e 10 56 00 02 00 6e 10 57 00 02 00 0a 07 22 06 ?? 00 6e 10 55 00 0b 00 0c 0c 13 0d 00 28 70 30 38 00 c6 0d 22 08 ?? 00 22 0c ?? 00 71 00 0f 00 00 00 0c 0d 6e 10 3b 00 0d 00 0c 0d 71 10 4d 00 0d 00 0c 0d 70 20 4f 00 dc 00 1a 0d 02 00 6e 20 51 00 dc 00 0c 0c 6e 10 52 00 0c 00 0c 0c 70 20 3c 00 c8 00 13 0c 00 04 23 c4 ?? 00 16 09 00 00 6e 20 3e 00 46 00 0a 03 12 fc 33 c3 0d 00 6e 10 40 00 08 00 6e 10 3f 00 08 00 6e 10 3d 00 06 00 12 0c 11 0c 81 3c bb c9 12 1c 23 cc ?? 00 12 0d 22 0e ?? 00 70 10 4e 00 0e 00 16 0f 64 00 bd 9f 81 70 05 11 00 00 9e 0f 0f 11 84 ff 6e 20 50 00 fe 00 0c 0e 6e 10 52 00 0e 00 0c 0e 4d 0e 0c 0d 08 00 13 00 6e 20 20 00 c0 00 12 0c 6e 40 41 00 48 3c 28 c7 0d 05 1a 0c ?? 00 6e 10 44 00 05 00 0c 0d 71 20 10 00 dc 00 28 cc }

        $S_7_12_346 = { 12 05 12 14 54 61 02 00 71 10 ?? 00 01 00 0c 01 6e 20 11 00 51 00 22 00 ?? 00 22 01 ?? 00 71 00 0f 00 00 00 0c 02 6e 10 3b 00 02 00 0c 02 71 10 4d 00 02 00 0c 02 70 20 4f 00 21 00 1a 02 02 00 6e 20 51 00 21 00 0c 01 6e 10 52 00 01 00 0c 01 70 20 39 00 10 00 54 61 02 00 6e 10 ?? 00 01 00 0c 01 1a 02 ?? 00 6e 20 48 00 21 00 0a 01 38 01 10 00 54 61 02 00 6e 10 ?? 00 01 00 0c 01 1a 02 ?? 00 6e 20 48 00 21 00 0a 01 39 01 1a 00 6e 10 3a 00 00 00 0a 01 38 01 4f 00 22 01 ?? 00 54 62 02 00 70 20 17 00 21 00 23 42 ?? 00 71 00 ?? 00 00 00 0c 03 4d 03 02 05 6e 20 1a 00 21 00 54 61 02 00 6e 10 ?? 00 01 00 0c 01 1a 02 ?? 00 6e 20 48 00 21 00 0a 01 38 01 11 00 54 61 02 00 6e 10 ?? 00 01 00 0c 01 1a 02 ?? 00 71 30 13 00 21 04 0c 01 6e 10 14 00 01 00 54 61 02 00 6e 10 ?? 00 01 00 0c 01 1a 02 ?? 00 6e 20 48 00 21 00 0a 01 38 01 11 00 54 61 02 00 6e 10 ?? 00 01 00 0c 01 1a 02 ?? 00 71 30 13 00 21 04 0c 01 6e 10 14 00 01 00 0e 00 22 01 ?? 00 54 62 02 00 70 20 17 00 21 00 23 42 ?? 00 71 00 ?? 00 00 00 0c 03 4d 03 02 05 6e 20 1a 00 21 00 28 b3 }

        $S_7_6f_60 = { 6f 20 01 00 32 00 15 00 03 7f 6e 20 2f 00 02 00 14 00 01 00 05 7f 6e 20 ?? 00 02 00 0c 00 1f 00 ?? 00 5b 20 04 00 54 20 04 00 22 01 ?? 00 70 20 15 00 21 00 6e 20 12 00 10 00 0e 00 }

        $S_7_12_116 = { 12 02 2b 04 33 00 00 00 12 00 11 00 22 00 ?? 00 70 20 02 00 30 00 5b 30 08 00 54 30 08 00 1a 01 ?? 00 6e 20 06 00 10 00 54 30 08 00 6e 20 04 00 20 00 54 30 08 00 13 01 64 00 6e 20 05 00 10 00 54 30 08 00 12 11 6e 20 08 00 10 00 54 30 08 00 6e 20 03 00 20 00 54 30 08 00 6e 10 09 00 00 00 54 30 08 00 28 d3 00 00 00 01 01 00 00 00 00 00 05 00 00 00 }

        $S_7_54_56 = { 54 30 03 00 12 01 6e 20 ?? 00 10 00 54 30 03 00 6e 10 ?? 00 00 00 0c 00 1a 01 ?? 00 12 12 71 30 13 00 10 02 0c 00 6e 10 14 00 00 00 54 30 03 00 6e 10 ?? 00 00 00 0e 00 }



    condition:

        all of them

}