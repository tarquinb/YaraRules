import "androguard"
import "droidbox"

rule Mazain
{
	meta:
		description = "Banker"
		family = "Mazain"

	condition:
		
		((androguard.receiver("com.example.livemusay.myapplication.DAdm") and 
		androguard.receiver("com.example.livemusay.myapplication.AlarM") and
		androguard.receiver("com.example.livemusay.myapplication.StartBoot")) or
		(androguard.receiver("com.adobe.flashplayer.abd.con7") and
		androguard.receiver("com.adobe.flashplayer.abd.con4") and
		androguard.receiver("com.adobe.flashplayer.abd.DAdm") and
		androguard.receiver("com.adobe.flashplayer.abd.con12") and
		androguard.receiver("com.adobe.flashplayer.abd.con3"))) and
		(androguard.permission("android.permission.GET_TASKS") and
		androguard.permission("android.permission.MODIFY_AUDIO_SETTINGS")) and
		droidbox.read.data("504b05060000000051005100691b0000eb4602000000504b01021703140000000800000000004658dcab5c08000028240000130000000000000000002000b68100000000416e64726f69644d616e69666573742e786d6c504b0102180014000000080000000000ccc21b1e1b0400009504000011000000000000000000000000008d0800004d4554412d494e462f434552542e525341504b0102180014000000080000000000dc4ee28fa0090000691d00001000000000000000000000000000d70c00004d4554412d494e462f434552542e5346504b0102180014000000080000000000efdbd9b5850900003e1d00001400000000000000000000000000a51600004d4554412d494e462f4d414e49464553542e4d46504b01021800140000000800000000006515bf0d6ecc0000dced01000b000000000000000000000000005c200000636c61737365732e646578504b01021703140000000800000000007808de697d01000004040000440000000000000000002000b681f3ec00007265732f616e696d2d7632312f67656e657269635f636f6e6669726d6174696f6e5f67656e657269635f636f6e6669726d6174696f6e5f616e696d6174696f6e2e786d6c504b0102170314000000080000000000843f641a82020000a8080000340000000000000000002000b681d2ee00007265732f616e696d2d7632312f67656e65")
}